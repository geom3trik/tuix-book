<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Creating a Counter Widget - Tuix Guide</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Overview</a></li><li class="chapter-item expanded affix "><li class="part-title">Quick Start Guide</li><li class="chapter-item expanded "><a href="../quick_start/intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../quick_start/creating_an_application.html"><strong aria-hidden="true">2.</strong> Creating an Application</a></li><li class="chapter-item expanded "><a href="../quick_start/setting_window_properties.html"><strong aria-hidden="true">3.</strong> Setting Window Properties</a></li><li class="chapter-item expanded "><a href="../quick_start/adding_a_widget.html"><strong aria-hidden="true">4.</strong> Adding a Button</a></li><li class="chapter-item expanded "><a href="../quick_start/positioning_the_widget.html"><strong aria-hidden="true">5.</strong> Positioning the Button</a></li><li class="chapter-item expanded "><a href="../quick_start/composing_widgets.html"><strong aria-hidden="true">6.</strong> Composing Widgets</a></li><li class="chapter-item expanded "><a href="../quick_start/widget_styling.html"><strong aria-hidden="true">7.</strong> Styling the App</a></li><li class="chapter-item expanded "><a href="../quick_start/custom_widget.html" class="active"><strong aria-hidden="true">8.</strong> Creating a Counter Widget</a></li><li class="chapter-item expanded "><a href="../quick_start/handling_events.html"><strong aria-hidden="true">9.</strong> Handling Events</a></li><li class="chapter-item expanded "><a href="../quick_start/reactivity_and_binding.html"><strong aria-hidden="true">10.</strong> Reactivity and Model Data</a></li><li class="chapter-item expanded "><a href="../quick_start/lenses_and_binding.html"><strong aria-hidden="true">11.</strong> Lenses and Binding</a></li><li class="chapter-item expanded "><a href="../quick_start/updating.html"><strong aria-hidden="true">12.</strong> Making the Counter Reusable</a></li><li class="chapter-item expanded affix "><li class="part-title">Layout</li><li class="chapter-item expanded "><a href="../layout/stack_overview.html"><strong aria-hidden="true">13.</strong> Overview (Stack)</a></li><li class="chapter-item expanded "><a href="../layout/child_properties.html"><strong aria-hidden="true">14.</strong> Child Properies</a></li><li class="chapter-item expanded "><a href="../layout/parent_properties.html"><strong aria-hidden="true">15.</strong> Parent Properies</a></li><li class="chapter-item expanded "><a href="../layout/grid_overview.html"><strong aria-hidden="true">16.</strong> Overview (Grid)</a></li><li class="chapter-item expanded "><a href="../layout/stacks.html"><strong aria-hidden="true">17.</strong> Stacks</a></li><li class="chapter-item expanded "><a href="../layout/positioning_text.html"><strong aria-hidden="true">18.</strong> Positioning Text</a></li><li class="chapter-item expanded "><a href="../layout/layout_properties.html"><strong aria-hidden="true">19.</strong> Layout Properties</a></li><li class="chapter-item expanded affix "><li class="part-title">Events</li><li class="chapter-item expanded "><a href="../events/chapter_1.html"><strong aria-hidden="true">20.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../events/events_and_messages.html"><strong aria-hidden="true">21.</strong> Events and Messages</a></li><li class="chapter-item expanded "><a href="../events/event_propagation.html"><strong aria-hidden="true">22.</strong> Event Propagation</a></li><li class="chapter-item expanded "><a href="../events/handling_events.html"><strong aria-hidden="true">23.</strong> Handling Events</a></li><li class="chapter-item expanded "><a href="../events/window_events.html"><strong aria-hidden="true">24.</strong> Window Events</a></li><li class="chapter-item expanded affix "><li class="part-title">Styling</li><li class="chapter-item expanded "><a href="../styling/overview.html"><strong aria-hidden="true">25.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../styling/inline_styling.html"><strong aria-hidden="true">26.</strong> Inline Styling</a></li><li class="chapter-item expanded "><a href="../styling/shared_styling.html"><strong aria-hidden="true">27.</strong> Shared Styling</a></li><li class="chapter-item expanded "><a href="../styling/style_properties.html"><strong aria-hidden="true">28.</strong> Style Properties</a></li><li class="chapter-item expanded "><a href="../styling/selectors.html"><strong aria-hidden="true">29.</strong> Selectors</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../styling/display.html"><strong aria-hidden="true">29.1.</strong> Display</a></li><li class="chapter-item expanded "><a href="../styling/background.html"><strong aria-hidden="true">29.2.</strong> Background</a></li><li class="chapter-item expanded "><a href="../styling/border.html"><strong aria-hidden="true">29.3.</strong> Border</a></li><li class="chapter-item expanded "><a href="../styling/shadows.html"><strong aria-hidden="true">29.4.</strong> Shadows</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Bindng</li><li class="chapter-item expanded "><a href="../binding/intro.html"><strong aria-hidden="true">30.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../binding/model.html"><strong aria-hidden="true">31.</strong> Model</a></li><li class="chapter-item expanded "><a href="../binding/lens.html"><strong aria-hidden="true">32.</strong> Lens</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Tuix Guide</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="creating-a-counter-widget"><a class="header" href="#creating-a-counter-widget">Creating a Counter Widget</a></h1>
<p>Our code so far produces something that <em>looks</em> like it could be a counter but it doesn't do anything yet. In the next section we'll dive into events and how we can use them to add some functionality to the app, but first we need to cover the concept of custom widgets.</p>
<p>So far we've used some of the built-in widgets in tuix to build our app, but it's time to build our own <code>Counter</code> widget to contain what we've built so far, and we'll also need it to react to events.</p>
<p>Start by creating a struct called <code>Counter</code>, and we'll derive <code>Default</code> so we don't need to write a constructor:</p>
<pre><code class="language-rs">#[derive(Default)]
struct Counter {
    value: i32,
}
</code></pre>
<p>Our counter contains the actual count value, an <code>i32</code>, which we'll need for later.</p>
<p>To make our <code>Counter</code> struct a widget we just need to implement the <code>Widget</code> trait for it like so:</p>
<pre><code class="language-rs">impl Widget for Counter {
    type Ret = Entity;
    type Data = ();

    fn on_build(&amp;mut self, state: &amp;mut State, entity: Entity) -&gt; Self::Ret {
        entity
    }
}
</code></pre>
<p>Let's take a moment to break down the pieces of the <code>Widget</code> trait. There are two associated types, <code>Ret</code> and <code>Data</code>:</p>
<ul>
<li>The <code>Ret</code> associated type is used to specify what should be returned when the widget is built. Typically a widget will return its <code>Entity</code> id, but a widget could be made up of several sub-widgets, some of which the user may need access to when building. In these cases the <code>Ret</code> type can be set to a tuple, such as <code>(Entity, Entity)</code>. For our counter we'll just return an <code>Entity</code>.</li>
<li>The <code>Data</code> associated type is used by the binding system, which for now we will save for a later section of the guide. In the meantime you can set this to <code>()</code>.</li>
</ul>
<p>The <code>Widget</code> trait has a few methods, but only the <code>on_build()</code> method is required to be implemented, and must return the <code>Ret</code> associated type. Usually this will be the entity id of the widget which is passed as an argument to the function.</p>
<p>The <code>on_build</code> method is called once when the widget is first built. So when we called <code>build()</code> on the buttons and label, their respective <code>on_build()</code> methods were called. It is within this function that we can build the components which will make up our widget. Note also that this method provides a mutable reference to <code>Self</code>, so we can access fields like our counter value, and a mutable reference to <code>State</code>, so we can set inline style properties of the widget at build time, using the <code>entity</code> id. </p>
<p>For the counter, we'll move the row, buttons, and label into the body of this method, making sure to change the parent of the row from <code>window</code> to <code>entity</code> (the id given to the <code>Counter</code> widget when it is built).</p>
<pre><code class="language-rs">impl Widget for Counter {
    type Ret = Entity;
    type Data = ();

    fn on_build(&amp;mut self, state: &amp;mut State, entity: Entity) -&gt; Self::Ret {

        // Note the change from window to entity
        let row = Row::new().build(state, entity, |builder| 
            builder
                .set_child_space(Stretch(1.0))
                .set_col_between(Pixels(10.0))
        );

        Button::with_label(&quot;Decrement&quot;).build(state, row, |builder| 
            builder
                .set_width(Pixels(100.0))
                .set_height(Pixels(30.0))
                .class(&quot;decrement&quot;)
        );

        Button::with_label(&quot;Increment&quot;).build(state, row, |builder| 
            builder
                .set_width(Pixels(100.0))
                .set_height(Pixels(30.0))
                .class(&quot;increment&quot;)
        );

        Label::new(&quot;0&quot;).build(state, row, |builder| 
            builder
                .set_width(Pixels(100.0))
                .set_height(Pixels(30.0))
        );

        entity
    }
}

</code></pre>
<p>Now that we have a counter wiget, which contains our buttons and label, how do we use it? Well, the same as any other widget! Where we had the row, buttons, and label, insert the following line:</p>
<pre><code class="language-rs">Counter::default().build(state, window, |builder| builder);
</code></pre>
<p>As with the row widget, the counter by default will fill the available space, and running the code appears to produce the same result as we had before:</p>
<p align="center"><img src="../images/quick_guide/styling_widgets.png" alt="tuix app"></p>
<p>That seemed like a lot of work for no noticable change. However, it's in the next section that things get interesting for our counter widget.</p>
<p>Also, here is the complete code so far:</p>
<pre><pre class="playground"><code class="language-rust">extern crate tuix;
use tuix::*;

const STYLE: &amp;str = r#&quot;

    button {
        border-radius: 3px;
        child-space: 1s;
    }

    button.increment {
        background-color: #2e7d32;
        border-radius: 3px;
    }

    button.increment:hover {
        background-color: #60ad5e;
    }

    button.increment:active {
        background-color: #005005;
    }
    
    button.decrement {
        background-color: #c62828;
        border-radius: 3px;
    }

    button.decrement:hover {
        background-color: #ff5f52;
    }

    button.decrement:active {
        background-color: #8e0000;
    }

    label {
        background-color: #404040;
        border-color: #606060;
        border-width: 1px;
        child-space: 1s;
    }
&quot;#;

#[derive(Default)]
struct Counter {
    value: i32,
}

impl Widget for Counter {
    type Ret = Entity;
    type Data = ();

    fn on_build(&amp;mut self, state: &amp;mut State, entity: Entity) -&gt; Self::Ret {
        let row = Row::new().build(state, entity, |builder| 
            builder
                .set_child_space(Stretch(1.0))
                .set_col_between(Pixels(10.0))
        );

        Button::with_label(&quot;Decrement&quot;).build(state, row, |builder| 
            builder
                .set_width(Pixels(100.0))
                .set_height(Pixels(30.0))
                .class(&quot;decrement&quot;)
        );

        Button::with_label(&quot;Increment&quot;).build(state, row, |builder| 
            builder
                .set_width(Pixels(100.0))
                .set_height(Pixels(30.0))
                .class(&quot;increment&quot;)
        );

        Label::new(&quot;0&quot;).build(state, row, |builder| 
            builder
                .set_width(Pixels(100.0))
                .set_height(Pixels(30.0))
        );

        entity
    }
}

fn main() {
    let window_description = WindowDescription::new()
        .with_title(&quot;Counter&quot;)
        .with_inner_size(400, 100);
    let app = Application::new(window_description, |state, window| {

        state.add_theme(STYLE);
        
        Counter::default().build(state, window, |builder| builder);

    });

    app.run();
}
</code></pre></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../quick_start/widget_styling.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../quick_start/handling_events.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../quick_start/widget_styling.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../quick_start/handling_events.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
